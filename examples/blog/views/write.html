 <!DOCTYPE html>
<html>
<head>
    <title>:: Geekskool Blog ::</title>
    <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Playfair+Display:300,400,700' rel='stylesheet' type='text/css'>  

    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script id="sdk-js" src="https://cdn.digits.com/1/sdk.js" async></script>
    <script src="js/react.js"></script>
    <script src="js/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>   

    <link rel="stylesheet" type="text/css" href="css/styles.css">
    <script type="text/javascript">

    document.getElementById('sdk-js').onload = function() {
        Digits.init({ consumerKey: 'MYFeeLrod8xbnfFeQLKhVWs7E' });
    };  
  
    function onLoginButtonClick(event){
        Digits.logIn()
        .done(onLogin) /*handle the response*/
        .fail(onLoginFailure);
    }

    function onLogin(loginResponse){
        var oAuthHeaders = loginResponse.oauth_echo_headers;
        var verifyData = {
            authHeader: oAuthHeaders['X-Verify-Credentials-Authorization'],
            apiUrl: oAuthHeaders['X-Auth-Service-Provider']
        };

        $.post('/verify',verifyData)
        .done(function(res){
            console.log(res)
            var obj = res;

             if (obj.status=='success'){
      console.log(obj)
                        window.location = '/';
                }
              else {
                console.log('failure')
            window.location = '/';
              } 
            });
    }

    function onLoginFailure(loginResponse){
        console.log(loginResponse);
    }
    

    </script>
</head>
<body>

 <header>
                <ul>
                    <li><a href="">Home</a></li>
                    <li><button id="digits-sdk" onclick="onLoginButtonClick()">Sign In</button></li>
                </ul>

                <h1>Geekskool Blog</h1>
                <h3>Write.  Share.  Learn</h3>
            </header>

            <div id="content"></div>
            <script type="text/babel">
                var Validate = React.createClass({  
                        getInitialState:function() {
                            return{
                                value:"",
                                titleLabel:"",
                                passLabel:"",
                                submitVar:""
                            }
                        },
                        validateNameFunc:function() {
                            var getTitle = this.refs.title.getDOMNode().value
                                if(getTitle.length < 5) {
                                    this.setState({
                                        titleLabel:"Name is too short",
                                    })
                                }
                                else if(getTitle.length == 0){
                                    this.setState({
                                         titleLabel:""
                                    })
                                }
                                else {
                                    this.setState({
                                        nameLabel:"",
                                        value:this.refs.title.getDOMNode().value                                 
                                    })
                                }
                            },
                        validateBlogFunc:function() {
                            var getBlog = this.refs.pass.getDOMNode().value
                                if(getBlog.length < 5) {
                                    this.setState({
                                        passLabel:"Password is too short"
                                    })
                                }
                                else {
                                    this.setState({
                                        passLabel:""
                                    })
                                }
                            },      
                        submit:function(){
                                this.setState({
                                    submitVar:"Form Submitted"  
                                }) 
                        },                  
                        render:function() {
                            return(
                                <div>
                                <form action="/new_blog" method="post">
                                <fieldset>
                                    <span className="error">{this.state.titleLabel}</span>
                                    <input type="text" ref="title" name="title" placeholder="Enter the title of the post" onChange={this.validateTitleFunc} />
                                    <textarea id="styled" ref="blog" placeholder="Enter your post" name="blog" onChange={this.validateBlogFunc}></textarea>
                                    <input type="submit" ref="submit" value="Sign in" onClick={this.submit} />
                                    <h5>{this.state.submitVar}</h5>     
                                </fieldset>                         
                                </form>
                                </div>
                                )
                        }
                    })


var Body = React.createClass({
    render:function(){
        return(
            <div className="wrapper">
            <Validate/>
            </div>
        )
    }
})

ReactDOM.render(<Body/>,document.getElementById('content'))

</script>

              <footer>
            Powered by Geekskool.
            </footer


</body>
</html>